<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add annotation underneath a plot — add_sub • cowplot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add annotation underneath a plot — add_sub"><meta property="og:description" content="This function can add an arbitrary label or mathematical expression underneath
the plot, similar to the sub parameter in base R. It is mostly superseded now by the
caption argument to ggplot2::labs(), and it is recommended to use caption instead of
add_sub() whenever possible."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cowplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/aligning_plots.html">Aligning plots</a>
    </li>
    <li>
      <a href="../articles/drawing_with_on_plots.html">Drawing with and on plots</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to cowplot</a>
    </li>
    <li>
      <a href="../articles/mixing_plot_frameworks.html">Mixing different plotting frameworks</a>
    </li>
    <li>
      <a href="../articles/plot_grid.html">Arranging plots in a grid</a>
    </li>
    <li>
      <a href="../articles/shared_legends.html">Shared legends</a>
    </li>
    <li>
      <a href="../articles/themes.html">Themes</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/wilkelab/cowplot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add annotation underneath a plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/wilkelab/cowplot/blob/HEAD/R/add_sub.R" class="external-link"><code>R/add_sub.R</code></a></small>
    <div class="hidden name"><code>add_sub.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function can add an arbitrary label or mathematical expression underneath
the plot, similar to the <code>sub</code> parameter in base R. It is mostly superseded now by the
<code>caption</code> argument to <code><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggplot2::labs()</a></code>, and it is recommended to use <code>caption</code> instead of
<code>add_sub()</code> whenever possible.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_sub</span><span class="op">(</span></span>
<span>  <span class="va">plot</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  x <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  y <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  vjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  vpadding <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"lines"</span><span class="op">)</span>,</span>
<span>  fontfamily <span class="op">=</span> <span class="st">""</span>,</span>
<span>  fontface <span class="op">=</span> <span class="st">"plain"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lineheight <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  <span class="va">colour</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>plot</dt>
<dd><p>A ggplot object or gtable object derived from a ggplot object.</p></dd>


<dt>label</dt>
<dd><p>The label with which the plot should be annotated. Can be a plotmath expression.</p></dd>


<dt>x</dt>
<dd><p>The x position of the label</p></dd>


<dt>y</dt>
<dd><p>The y position of the label</p></dd>


<dt>hjust</dt>
<dd><p>Horizontal justification</p></dd>


<dt>vjust</dt>
<dd><p>Vertical justification</p></dd>


<dt>vpadding</dt>
<dd><p>Vertical padding. The total vertical space added to the label, given in grid
units. By default, this is added equally above and below the label. However, by changing the
y and vjust parameters, this can be changed.</p></dd>


<dt>fontfamily</dt>
<dd><p>The font family</p></dd>


<dt>fontface</dt>
<dd><p>The font face ("plain", "bold", etc.)</p></dd>


<dt>color, colour</dt>
<dd><p>Text color</p></dd>


<dt>size</dt>
<dd><p>Point size of text</p></dd>


<dt>angle</dt>
<dd><p>Angle at which text is drawn</p></dd>


<dt>lineheight</dt>
<dd><p>Line height of text</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A gtable object holding the modified plot.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The exact location where the
label is placed is controlled by the parameters <code>x</code>, <code>y</code>, <code>hjust</code>, and
<code>vjust</code>. By default, all these parameters are set to 0.5, which places the label
centered underneath the plot panel. A value of <code>x = 0</code> indicates the left boundary
of the plot panel and a value of <code>x = 1</code> indicates the right boundary. The parameter
<code>hjust</code> works just as elsewhere in ggplot2. Thus, <code>x = 0, hjust = 0</code> places
the label left-justified at the left boundary of the plot panel, <code>x = 0.5, hjust = 0.5</code>
places the label centered underneath the plot panel, and <code>x = 1, hjust = 1</code> places
it right-justified at the right boundary of the plot panel. <code>x</code>-values below 0 or
above 1 are allowed, and they move the label beyond the limits of the plot panel.</p>
<p>The <code>y</code> coordinates are relative to the added vertical space that is introduced
underneath the x-axis label to place the annotation. A value of <code>y=0</code> indicates
the bottom-most edge of that space and a value of <code>y=1</code> indicates the top-most
edge of that space. The total height of the added space is given by the height needed
to draw the label plus the value of <code>vpadding</code>. Thus, if <code>y=0, vjust=0</code> then
the extra padding is added entirely above the label, if <code>y=1, vjust=1</code> then the
extra padding is added entirely below the label, and if <code>y=0.5, vjust=0.5</code> (the
default) then the extra padding is added equally above and below the label. As is the
case with <code>x</code>, <code>y</code>-values outside the range 0-1 are allowed. In particular,
for sufficiently large values of <code>y</code>, the label will eventually be located inside
the plot panel.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="background_grid.html">background_grid</a></span><span class="op">(</span>minor<span class="op">=</span><span class="st">'none'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="fu">add_sub</span><span class="op">(</span><span class="va">p1</span>, <span class="st">"This is an annotation.\nAnnotations can span multiple lines."</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_sub-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also do this repeatedly.</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">add_sub</span><span class="op">(</span><span class="va">p1</span>, <span class="st">"This formula has no relevance here:"</span>, y  <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">add_sub</span><span class="op">(</span><span class="va">p2</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">a</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">b</span><span class="op">^</span><span class="fl">2</span>, <span class="st">" = "</span>, <span class="va">c</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_sub-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#This code also works with faceted plots:</span></span></span>
<span class="r-in"><span><span class="va">plot.iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Species</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">stat_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="background_grid.html">background_grid</a></span><span class="op">(</span>major <span class="op">=</span> <span class="st">'y'</span>, minor <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># add thin horizontal lines</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="panel_border.html">panel_border</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># and a border around each panel</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">add_sub</span><span class="op">(</span><span class="va">plot.iris</span>, <span class="st">"Annotation underneath a faceted plot, left justified."</span>, x <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-in"><span><span class="fu"><a href="ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_sub-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Finally, it is possible to move the annotation inside of the plot if desired.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="fu">add_sub</span><span class="op">(</span><span class="va">p1</span>, <span class="st">"Annotation inside plot"</span>, vpadding<span class="op">=</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"lines"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       y <span class="op">=</span> <span class="fl">6</span>, x <span class="op">=</span> <span class="fl">0.03</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="add_sub-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

