<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drawing with and on plots • cowplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Drawing with and on plots">
<meta property="og:description" content="cowplot">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cowplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aligning_plots.html">Aligning plots</a>
    </li>
    <li>
      <a href="../articles/drawing_with_on_plots.html">Drawing with and on plots</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Introduction to cowplot</a>
    </li>
    <li>
      <a href="../articles/mixing_plot_frameworks.html">Mixing different plotting frameworks</a>
    </li>
    <li>
      <a href="../articles/plot_grid.html">Arranging plots in a grid</a>
    </li>
    <li>
      <a href="../articles/shared_legends.html">Shared legends</a>
    </li>
    <li>
      <a href="../articles/themes.html">Themes</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wilkelab/cowplot/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Drawing with and on plots</h1>
                        <h4 data-toc-skip class="author">Claus O.
Wilke</h4>
            
            <h4 data-toc-skip class="date">2023-12-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wilkelab/cowplot/blob/HEAD/vignettes/drawing_with_on_plots.Rmd" class="external-link"><code>vignettes/drawing_with_on_plots.Rmd</code></a></small>
      <div class="hidden name"><code>drawing_with_on_plots.Rmd</code></div>

    </div>

    
    
<p>The cowplot package provides functions to draw with and on plots.
These functions enable us to take plots and add arbitrary annotations or
backgrounds, to place plots inside of other plots, to arrange plots in
more complicated layouts, or to combine plots from different graphic
systems (ggplot2, grid, lattice, base). This functionality is build on
top of ggplot2, i.e., the resulting plots are ggplot2 objects and they
can be modified, extended, and outputted just like regular ggplot2
plots.</p>
<div class="section level2">
<h2 id="basic-annotations">Basic annotations<a class="anchor" aria-label="anchor" href="#basic-annotations"></a>
</h2>
<p>We start with some simple annotations, such as labels or watermarks.
Let’s begin with a basic plot of the <code>mpg</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">displ</span>, <span class="va">cty</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_minimal_grid.html">theme_minimal_grid</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-2-1.png" width="384"></p>
<p>Next we’re going to watermark this plot with the word “Draft”. To do
so, we wrap the plot into a drawing environment via the
<code><a href="../reference/ggdraw.html">ggdraw()</a></code> call, and then add annotations via various
<code>draw_*()</code> functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
<p>What <code>ggdraw(p)</code> does is it captures a snapshot of the
plot, so that the plot effectively turns into an image, and then it
draws that image into a new ggplot2 canvas without visible axes or
background grid. The <code>draw_*</code> functions are simply wrappers
around regular geoms. So, in the above example we could have used
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code> instead of <code><a href="../reference/draw_label.html">draw_label()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span>, y <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="st">"Draft"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span><span class="op">)</span>,</span>
<span>    hjust <span class="op">=</span> <span class="fl">0.5</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, angle <span class="op">=</span> <span class="fl">45</span>, size <span class="op">=</span> <span class="fl">100</span><span class="op">/</span><span class="va">.pt</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#C0A0A0"</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
<p>However, notice how much more verbose the call to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code> is. Also, <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text()</a></code> interprets
font sizes in mm, so we need to divide by <code>.pt</code> if we want to
specify font sizes in the more conventional point metric. By contrast,
<code><a href="../reference/draw_label.html">draw_label()</a></code> performs this conversion for us, so we can
specify font sizes directly in points.</p>
<p>Because <code><a href="../reference/ggdraw.html">ggdraw()</a></code> is built on top of ggplot2, we can
treat its output like a ggplot2 plot. For example, we can use the
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> function to change the background color.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"cornsilk"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
<p>We can also save the annotated plots in the standard way via
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draft</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"draft.pdf"</span>, <span class="va">draft</span><span class="op">)</span></span></code></pre></div>
<p>(However, the cowplot package provides an alternative to
<code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code>, the function <code><a href="../reference/save_plot.html">save_plot()</a></code>, which
makes it easier to save plots with appropriate sizing, in particular
when making compound plots. See the documentation of
<code><a href="../reference/save_plot.html">save_plot()</a></code> for details.)</p>
<p>Frequently, we may want to have the annotations underneath the plot
rather than on top of it. We can achieve this effect by first setting up
an empty drawing layer with <code><a href="../reference/ggdraw.html">ggdraw()</a></code>, then adding the
label, and then adding the plot with <code><a href="../reference/draw_plot.html">draw_plot()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
<p>This requires that the plot has a transparent background, and all
cowplot themes meet this requirement. By contrast, this is not
necessarily the case for ggplot2 themes. For example, if we change the
theme of the plot to <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic()</a></code> the underlying label
is hidden by the theme’s white background.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<p>The cowplot theme <code><a href="../reference/theme_cowplot.html">theme_half_open()</a></code> does not have this
limitation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_label.html">draw_label</a></span><span class="op">(</span><span class="st">"Draft"</span>, color <span class="op">=</span> <span class="st">"#C0A0A0"</span>, size <span class="op">=</span> <span class="fl">100</span>, angle <span class="op">=</span> <span class="fl">45</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-9-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="making-inset-plots">Making inset plots<a class="anchor" aria-label="anchor" href="#making-inset-plots"></a>
</h2>
<p>The <code><a href="../reference/draw_plot.html">draw_plot()</a></code> function also allows us to place plots
at arbitrary locations and at arbitrary sizes onto the canvas. This is
useful for combining subplots into a layout that is not a simple grid,
e.g. with an inset plotted inside a larger graph.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">drv</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue2"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_minimal_grid.html">theme_minimal_hgrid</a></span><span class="op">(</span><span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span><span class="va">inset</span>, <span class="fl">.45</span>, <span class="fl">.45</span>, <span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot_label.html">draw_plot_label</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.45</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>This feature is not limited to ggplot2 plots. It works with base
graphics as well.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inset</span> <span class="op">&lt;-</span> <span class="op">~</span><span class="op">{</span></span>
<span>  <span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">mpg</span><span class="op">$</span><span class="va">drv</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span></span>
<span>    cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">counts</span>, xlab <span class="op">=</span> <span class="st">"drv"</span>, ylab <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span><span class="va">inset</span>, <span class="fl">.45</span>, <span class="fl">.45</span>, <span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_plot_label.html">draw_plot_label</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.45</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="absolute-positioning">Absolute positioning<a class="anchor" aria-label="anchor" href="#absolute-positioning"></a>
</h2>
<p>By default, the coordinate system used by <code><a href="../reference/ggdraw.html">ggdraw()</a></code> uses
relative coordinates running from 0 to 1 for both x and y. Sometimes,
however, we need to be able to place graphical elements at absolute
units, e.g. exactly 1 inch from the left border. We can do so via the
grid graphic system, which is supported through the
<code><a href="../reference/draw_grob.html">draw_grob()</a></code> function. For example, the following code
generates a blue square of 1 inch width and height that is located
exactly 1 inch from the left and 1 inch from the top border of the plot
area.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="va">rect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.rect.html" class="external-link">rectGrob</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"in"</span><span class="op">)</span>,</span>
<span>  hjust <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue2"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_grob.html">draw_grob</a></span><span class="op">(</span><span class="va">rect</span><span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-12-1.png" width="384"></p>
<p>If we regenerate the plot in a different size, the blue square
remains at the same absolute position and retains its absolute size.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_grob.html">draw_grob</a></span><span class="op">(</span><span class="va">rect</span><span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="combining-plots-and-images">Combining plots and images<a class="anchor" aria-label="anchor" href="#combining-plots-and-images"></a>
</h2>
<p>The drawing layer also supports images, through the function
<code><a href="../reference/draw_image.html">draw_image()</a></code>. This function, which requires the <a href="https://CRAN.R-project.org/package=magick" class="external-link">magick</a> package to
be installed, can take images in many different formats and combine them
with plots. For example, we can use an image as a plot background:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/magick/" class="external-link">magick</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"cow.jpg"</span>, package <span class="op">=</span> <span class="st">"cowplot"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/editing.html" class="external-link">image_read</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/transform.html" class="external-link">image_resize</a></span><span class="op">(</span><span class="st">"570x380"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/magick/reference/color.html" class="external-link">image_colorize</a></span><span class="op">(</span><span class="fl">35</span>, <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">PASWR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/PASWR/man/Cows.html" class="external-link">Cows</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">breed</span> <span class="op">!=</span> <span class="st">"Canadian"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>breed <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder</a></span><span class="op">(</span><span class="va">breed</span>, <span class="va">butterfat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">butterfat</span>, fill <span class="op">=</span> <span class="va">breed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html" class="external-link">scale_fill_grey</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_minimal_grid.html">theme_minimal_hgrid</a></span><span class="op">(</span><span class="fl">11</span>, color <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_image.html">draw_image</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-14-1.png" width="547.2"></p>
<p>We can also add an image as a logo onto a plot. We use
<code>halign</code> and <code>valign</code> in addition to
<code>hjust</code> and <code>vjust</code> to align the image flush in
the top right corner.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logo_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"logo.png"</span>, package <span class="op">=</span> <span class="st">"cowplot"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggdraw.html">ggdraw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/draw_plot.html">draw_plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/draw_image.html">draw_image</a></span><span class="op">(</span></span>
<span>    <span class="va">logo_file</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">1</span>, vjust <span class="op">=</span> <span class="fl">1</span>, halign <span class="op">=</span> <span class="fl">1</span>, valign <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">0.15</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="drawing_with_on_plots_files/figure-html/unnamed-chunk-15-1.png" width="547.2"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Claus O. Wilke.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
